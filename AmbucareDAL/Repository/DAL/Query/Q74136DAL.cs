using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Web;
using AmbucareDAL.Models;

namespace AmbucareDAL.Repository.DAL.Query
{
    public class Q74136DAL : CommonDAL
    {
        //public DataTable GetNotificationData(string language)
        //{
        //    return Query($"SELECT DISTINCT T74041.T_PAT_ID, T74041.T_REQUEST_DATE, T74041.T_REQUEST_TIME, T74041.T_REQUEST_ID, T74046.T_FIRST_LANG{language}_NAME T_FIRST_NAME, T74046.T_FATHER_LANG{language}_NAME T_FATHER_NAME, T74046.T_GFATHER_LANG{language}_NAME T_GFATHER_NAME, T74041.T_AGE, T74050.T_SHORT_GNDR_NAME, T74041.T_AMBU_REG_ID, T74057.T_USER_ID, T74004.T_FIRST_LANG{language}_NAME T_OPE_FIRST_NAME, T74004.T_GFATHER_LANG{language}_NAME T_OPE_LAST_NAME, 'Name: ' || T74046.T_FIRST_LANG{language}_NAME ||' ' ||T74046.T_FATHER_LANG{language}_NAME ||' ' ||T74046.T_GFATHER_LANG{language}_NAME ||'  ' ||'Age: ' ||' ' || T74041.T_AGE ||'  ' || 'Sex: ' ||' ' || T74050.T_SHORT_GNDR_NAME ||'  ' ||'Mob: ' ||T74046.T_MOBILE_NO T_PAT_INFO, 'Amb ID: ' || T74041.T_AMBU_REG_ID ||'  ' ||'Team ID: ' ||T74057.T_USER_ID ||'  ' ||'Cont.Person: ' ||T74004.T_FIRST_LANG{language}_NAME ||' ' ||T74004.T_FATHER_LANG{language}_NAME ||'  ' || T74004.T_GFATHER_LANG{language}_NAME ||'  ' || 'Mob: ' || T74004.T_MOBILE_NO T_ASSIGN_TO, (SELECT CASE WHEN t41.T_CHAT_DOC_ID IS NULL THEN '' ELSE 'Doc Id: ' || t41.T_CHAT_DOC_ID||'  ' ||'Name: ' || T74004.T_FIRST_LANG{language}_NAME ||' ' ||T74004.T_FATHER_LANG{language}_NAME ||' ' ||T74004.T_GFATHER_LANG{language}_NAME||'  ' ||'Mob: ' ||T74004.T_MOBILE_NO END DOCTOR_INFO FROM T74004 INNER JOIN T74057 ON T74004.T_EMP_ID=T74057.T_EMP_ID INNER JOIN T74041 t41 ON T74057.T_USER_ID=t41.T_CHAT_DOC_ID where t41.T_REQUEST_ID=t74041.T_REQUEST_ID)DOCTOR_INFO, T74041.T_ASSIGN_TIME ASIGN_DATE, T74041.T_ASSIGN_TIME ASIGN_TIME, T74041.T_ACCEPT_TIME ACCEPT_DATE, T74041.T_ACCEPT_TIME ACCEPT_TIME, T74041.T_SEEN_DATE CASE_RECEIVED_DATE, T74041.T_SEEN_TIME CASE_RECEIVED_TIME, T74041.T_CANCEL_STATUS, T74041.T_CANCEL_REASON, T74041.T_START_TIME DIST_START_DATE, T74041.T_START_TIME DIST_START_TIME, rtrim(ltrim(T02065.T_LANG{language}_NAME)) HANDOVER_TO, T74041.T_DISCHARGE_DATE HANDOVER_DATE, T74041.T_DISCHARGE_TIME HANDOVER_TIME FROM T74041 LEFT JOIN T74046 ON T74041.T_PAT_ID=T74046.T_PAT_ID LEFT JOIN T74050 ON T74050.T_SEX_CODE =T74046.T_SEX_CODE LEFT OUTER JOIN T74044 ON T74041.T_AMBU_REG_ID=T74044.T_AMBU_REG_ID LEFT OUTER JOIN T02065 ON T74041.T_SITE_DIS_CODE=T02065.T_SITE_CODE LEFT OUTER JOIN T74057 ON T74041.T_USER_ID=T74057.T_USER_ID LEFT OUTER JOIN T74004 ON T74057.T_EMP_ID=T74004.T_EMP_ID LEFT OUTER JOIN T74015 ON T74057.T_EMP_ID=T74015.T_EMP_ID LEFT OUTER JOIN T74005 ON T74004.T_EMP_TYP_ID = T74005.T_EMP_TYP_ID WHERE (TO_DATE(T74041.T_REQUEST_DATE)=TO_DATE(TRUNC(sysdate-1)) OR TO_DATE(T74041.T_REQUEST_DATE)=TO_DATE(TRUNC(sysdate))) GROUP BY T74041.T_PAT_ID, T74041.T_REQUEST_DATE, T74041.T_REQUEST_TIME, T74041.T_REQUEST_ID, T74046.T_FIRST_LANG{language}_NAME, T74046.T_FATHER_LANG{language}_NAME , T74046.T_GFATHER_LANG{language}_NAME, T74041.T_AGE, T74050.T_SHORT_GNDR_NAME, T74041.T_AMBU_REG_ID, T74057.T_USER_ID, T74004.T_FIRST_LANG{language}_NAME, T74004.T_GFATHER_LANG{language}_NAME, 'Name: ' || T74046.T_FIRST_LANG{language}_NAME ||' ' ||T74046.T_FATHER_LANG{language}_NAME ||' ' ||T74046.T_GFATHER_LANG{language}_NAME ||'  ' ||'Age: ' ||' ' || T74041.T_AGE ||'  ' || 'Sex: ' ||' ' || T74050.T_SHORT_GNDR_NAME ||'  ' ||'Mob: ' ||T74046.T_MOBILE_NO, 'Amb ID: ' || T74041.T_AMBU_REG_ID ||'  ' ||'Team ID: ' ||T74057.T_USER_ID ||'  ' ||'Cont.Person: ' || T74004.T_FIRST_LANG{language}_NAME ||' ' ||T74004.T_FATHER_LANG{language}_NAME ||'  ' || T74004.T_GFATHER_LANG{language}_NAME ||'  ' || 'Mob: ' || T74004.T_MOBILE_NO , T74041.T_ASSIGN_TIME, T74041.T_ASSIGN_TIME, T74041.T_ACCEPT_TIME, T74041.T_ACCEPT_TIME, T74041.T_SEEN_DATE, T74041.T_SEEN_TIME, T74041.T_START_TIME, T74041.T_START_TIME, T02065.T_LANG{language}_NAME, T74041.T_CANCEL_STATUS, T74041.T_CANCEL_REASON, T74041.T_DISCHARGE_DATE, T74041.T_DISCHARGE_TIME ORDER BY T74041.T_REQUEST_ID DESC, T74041.T_PAT_ID");

        //}


        public DataTable GetNotificationData(string language, string zonCode)
        {
            //return Query(
            //    $"SELECT * from (SELECT DISTINCT T74041.T_PAT_ID,T74041.T_REQUEST_DATE T_REQUEST_DATE, T74041.T_REQUEST_TIME T_REQUEST_TIME, T74041.T_REQUEST_ID T_REQUEST_ID, T74046.T_FIRST_LANG2_NAME T_FIRST_NAME, T74046.T_FATHER_LANG2_NAME T_FATHER_NAME, T74046.T_GFATHER_LANG2_NAME T_GFATHER_NAME, T74041.T_AGE T_AGE, T74050.T_SHORT_GNDR_NAME T_SHORT_GNDR_NAME, T74041.T_AMBU_REG_ID T_AMBU_REG_ID, T74057.T_USER_ID T_USER_ID, T74004.T_FIRST_LANG2_NAME T_OPE_FIRST_NAME, T74004.T_GFATHER_LANG2_NAME T_OPE_LAST_NAME, 'Name: ' || T74046.T_FIRST_LANG2_NAME || ' ' || T74046.T_FATHER_LANG2_NAME || ' ' ||T74046.T_GFATHER_LANG2_NAME || '  ' || 'Age: ' || ' ' || T74041.T_AGE || '  ' || 'Sex: ' || ' ' ||T74050.T_SHORT_GNDR_NAME || '  ' || 'Mob: ' || T74046.T_MOBILE_NO T_PAT_INFO,'Amb ID: ' || T74041.T_AMBU_REG_ID || '  ' || 'Team ID: ' || T74057.T_USER_ID || '  ' || 'Cont.Person: ' ||T74004.T_FIRST_LANG2_NAME || ' ' || T74004.T_FATHER_LANG2_NAME || '  ' || T74004.T_GFATHER_LANG2_NAME ||'  ' || 'Mob: ' ||T74004.T_MOBILE_NO T_ASSIGN_TO,(SELECT CASE WHEN t41.T_CHAT_DOC_ID IS NULL THEN ''ELSE 'Doc Id: ' ||t41.T_CHAT_DOC_ID || '  ' || 'Name: ' || T74004.T_FIRST_LANG2_NAME || ' ' ||T74004.T_FATHER_LANG2_NAME || ' ' || T74004.T_GFATHER_LANG2_NAME || '  '|| 'Mob: ' ||T74004.T_MOBILE_NO END DOCTOR_INFO FROM T74004 INNER JOIN T74057 ON T74004.T_EMP_ID = T74057.T_EMP_ID INNER JOIN T74041 t41 ON T74057.T_USER_ID = t41.T_CHAT_DOC_ID WHERE t41.T_REQUEST_ID = t74041.T_REQUEST_ID )DOCTOR_INFO,T74041.T_ASSIGN_TIME ASIGN_DATE, T74041.T_ASSIGN_TIME ASIGN_TIME, T74041.T_ACCEPT_TIME ACCEPT_DATE, T74041.T_ACCEPT_TIME ACCEPT_TIME, T74041.T_SEEN_DATE CASE_RECEIVED_DATE, T74041.T_SEEN_TIME CASE_RECEIVED_TIME, T74041.T_CANCEL_STATUS,T74041.T_CANCEL_REASON,T74041.T_START_TIME DIST_START_DATE, T74041.T_START_TIME DIST_START_TIME, rtrim(ltrim(T02065.T_LANG2_NAME)) HANDOVER_TO,T74041.T_DISCHARGE_DATE HANDOVER_DATE, T74041.T_DISCHARGE_TIME HANDOVER_TIME, T74041.T_TEAM_ARVL_HOS HOSPITAL_ARRIVAL,T74041.T_TEAM_ARVL_STN HOSPITAL_STATION,T74041.T_TEAM_DEPT_HOS HOSPITAL_DEPARTURE,null as T_PANIC_ID,T74041.T_OPER_CNCL_FLAG,T74041.T_REF_DOC_CODE,T74041.T_DOC_REQ_ACPT_DATE,T74041.T_OPER_DES_CODE,T74041.T_OPER_ACPT_DATE,T74041.T_DISCH_STATUS FROM T74041 LEFT JOIN T74046 ON T74041.T_PAT_ID = T74046.T_PAT_ID LEFT JOIN T74050 ON T74050.T_SEX_CODE = T74046.T_SEX_CODE LEFT OUTER JOIN T74044 ON T74041.T_AMBU_REG_ID = T74044.T_AMBU_REG_ID LEFT OUTER JOIN T02065 ON T74041.T_SITE_DIS_CODE = T02065.T_SITE_CODE LEFT OUTER JOIN T74057 ON T74041.T_USER_ID = T74057.T_USER_ID LEFT OUTER JOIN T74004 ON T74057.T_EMP_ID = T74004.T_EMP_ID LEFT OUTER JOIN T74015 ON T74057.T_EMP_ID = T74015.T_EMP_ID LEFT OUTER JOIN T74005 ON T74004.T_EMP_TYP_ID = T74005.T_EMP_TYP_ID WHERE(TO_DATE(T74041.T_REQUEST_DATE) = TO_DATE(TRUNC(sysdate - 1)) OR TO_DATE(T74041.T_REQUEST_DATE) = TO_DATE(TRUNC(sysdate))) GROUP BY T74041.T_PAT_ID,T74041.T_REQUEST_DATE,T74041.T_REQUEST_TIME,T74041.T_REQUEST_ID,T74046.T_FIRST_LANG2_NAME,T74046 .T_FATHER_LANG2_NAME ,T74046.T_GFATHER_LANG2_NAME,T74041.T_AGE,T74050.T_SHORT_GNDR_NAME,T74041.T_AMBU_REG_ID,T74057.T_USER_ID,T74004.T_FIRST_LANG2_NAME,T74004.T_GFATHER_LANG2_NAME,'Name: ' || T74046.T_FIRST_LANG2_NAME || ' ' || T74046.T_FATHER_LANG2_NAME || ' ' || T74046.T_GFATHER_LANG2_NAME ||'  ' || 'Age: ' || ' ' || T74041.T_AGE || '  ' || 'Sex: ' || ' ' || T74050.T_SHORT_GNDR_NAME || '  ' ||'Mob: ' || T74046.T_MOBILE_NO,'Amb ID: ' || T74041.T_AMBU_REG_ID || '  ' || 'Team ID: ' ||T74057.T_USER_ID || '  ' || 'Cont.Person: ' || T74004.T_FIRST_LANG2_NAME || ' ' ||T74004.T_FATHER_LANG2_NAME || '  ' || T74004.T_GFATHER_LANG2_NAME || '  ' || 'Mob: ' ||T74004.T_MOBILE_NO ,T74041.T_ASSIGN_TIME , T74041.T_ASSIGN_TIME ,T74041.T_ACCEPT_TIME ,T74041.T_ACCEPT_TIME ,T74041.T_SEEN_DATE ,T74041.T_SEEN_TIME ,T74041.T_START_TIME,T74041.T_START_TIME,T02065.T_LANG2_NAME,T74041.T_CANCEL_STATUS,T74041.T_CANCEL_REASON,T74041.T_DISCHARGE_DATE,T74041.T_DISCHARGE_TIME,T74041.T_TEAM_ARVL_HOS ,T74041.T_TEAM_ARVL_STN ,T74041.T_TEAM_DEPT_HOS,T74041.T_OPER_CNCL_FLAG,T74041.T_REF_DOC_CODE,T74041.T_DOC_REQ_ACPT_DATE,T74041.T_OPER_DES_CODE,T74041.T_OPER_ACPT_DATE,T74041.T_DISCH_STATUS UNION SELECT NULL AS T_PAT_ID, T_ENTRY_TIME AS T_REQUEST_DATE, T_ENTRY_TIME AS T_REQUEST_TIME, T_REQUEST_ID, NULL AS T_FIRST_NAME, NULL AS T_FATHER_NAME, NULL AS T_GFATHER_NAME, NULL AS T_AGE, NULL AS T_SHORT_GNDR_NAME, NULL AS T_AMBU_REG_ID, nvl(T_USER_ID,T_DEVICES) T_USER_ID, NULL AS T_OPE_FIRST_NAME, NULL AS T_OPE_LAST_NAME, NULL AS T_PAT_INFO, NULL AS T_ASSIGN_TO, NULL AS DOCTOR_INFO, NULL AS ASIGN_DATE, NULL AS ASIGN_TIME, NULL AS ACCEPT_DATE, NULL AS ACCEPT_TIME, NULL AS CASE_RECEIVED_DATE, NULL AS CASE_RECEIVED_TIME, NULL AS T_CANCEL_STATUS, NULL AS T_CANCEL_REASON, NULL AS DIST_START_DATE, NULL AS DIST_START_TIME, T_ADDRESS AS HANDOVER_TO, NULL AS HANDOVER_DATE, NULL AS HANDOVER_TIME, NULL AS HOSPITAL_ARRIVAL, NULL AS HOSPITAL_STATION, NULL AS HOSPITAL_DEPARTURE, T_PANIC_ID, NULL AS T_OPER_CNCL_FLAG,NULL AS T_REF_DOC_CODE,NULL AS T_DOC_REQ_ACPT_DATE,NULL AS T_OPER_DES_CODE,NULL AS T_OPER_ACPT_DATE,NULL AS T_DISCH_STATUS FROM (SELECT T_USER_ID,T_DEVICES, T_ENTRY_TIME,T_REQUEST_ID,T_ADDRESS,T_PANIC_ID, rank() over (partition BY T_USER_ID order by T_ENTRY_TIME DESC) ranks FROM t74103 ) WHERE ranks = 1)ORDER BY T_REQUEST_ID DESC NULLS LAST, T_PAT_ID");
            return Query(
                $"SELECT * FROM (SELECT DISTINCT T74041.T_PAT_ID, T74041.T_REQUEST_DATE T_REQUEST_DATE, T74041.T_REQUEST_TIME T_REQUEST_TIME, T74041.T_REQUEST_ID T_REQUEST_ID, T74046.T_FIRST_LANG{language}_NAME T_FIRST_NAME, T74046.T_FATHER_LANG{language}_NAME T_FATHER_NAME, T74046.T_GFATHER_LANG{language}_NAME T_GFATHER_NAME, T74041.T_AGE T_AGE, T74050.T_SHORT_GNDR_NAME T_SHORT_GNDR_NAME, T74041.T_AMBU_REG_ID T_AMBU_REG_ID, T74057.T_USER_ID T_USER_ID, T74004.T_FIRST_LANG{language}_NAME T_OPE_FIRST_NAME, T74004.T_GFATHER_LANG{language}_NAME T_OPE_LAST_NAME, 'Name: ' || T74046.T_FIRST_LANG{language}_NAME || ' ' || T74046.T_FATHER_LANG{language}_NAME || ' ' ||T74046.T_GFATHER_LANG{language}_NAME || ' ' || 'Age: ' || ' ' || T74041.T_AGE || ' ' || 'Sex: ' || ' ' ||T74050.T_SHORT_GNDR_NAME || ' ' || 'Mob: ' || T74046.T_MOBILE_NO T_PAT_INFO, 'Amb ID: ' || T74041.T_AMBU_REG_ID || ' ' || 'Team ID: ' || T74057.T_USER_ID || ' ' || 'Cont.Person: ' ||T74004.T_FIRST_LANG{language}_NAME || ' ' || T74004.T_FATHER_LANG{language}_NAME || ' ' || T74004.T_GFATHER_LANG{language}_NAME ||' ' || 'Mob: ' ||T74004.T_MOBILE_NO T_ASSIGN_TO, (SELECT CASE WHEN t41.T_CHAT_DOC_ID IS NULL THEN '' ELSE 'Doc Id: ' ||t41.T_CHAT_DOC_ID || ' ' || 'Name: ' || T74004.T_FIRST_LANG{language}_NAME || ' ' ||T74004.T_FATHER_LANG{language}_NAME || ' ' || T74004.T_GFATHER_LANG{language}_NAME || ' ' || 'Mob: ' ||T74004.T_MOBILE_NO END DOCTOR_INFO FROM T74004 INNER JOIN T74057 ON T74004.T_EMP_ID = T74057.T_EMP_ID INNER JOIN T74041 t41 ON T74057.T_USER_ID = t41.T_CHAT_DOC_ID WHERE t41.T_REQUEST_ID = t74041.T_REQUEST_ID )DOCTOR_INFO, T74041.T_ASSIGN_TIME ASIGN_DATE, T74041.T_ASSIGN_TIME ASIGN_TIME, T74041.T_ACCEPT_TIME ACCEPT_DATE, T74041.T_ACCEPT_TIME ACCEPT_TIME, T74041.T_SEEN_DATE CASE_RECEIVED_DATE, T74041.T_SEEN_TIME CASE_RECEIVED_TIME, T74041.T_CANCEL_STATUS, T74041.T_CANCEL_REASON, T74041.T_CAN_DATE, T74041.T_OPER_CNCL_DATE, T74041.T_START_TIME DIST_START_DATE, T74041.T_START_TIME DIST_START_TIME, rtrim(ltrim(T02065.T_LANG{language}_NAME)) HANDOVER_TO, T74041.T_DISCHARGE_DATE HANDOVER_DATE, T74041.T_DISCHARGE_TIME HANDOVER_TIME, T74041.T_TEAM_ARVL_HOS HOSPITAL_ARRIVAL, T74041.T_TEAM_ARVL_STN HOSPITAL_STATION, T74041.T_TEAM_DEPT_HOS HOSPITAL_DEPARTURE, NULL AS T_PANIC_ID, T74041.T_OPER_CNCL_FLAG, T74041.T_REF_DOC_CODE, T74041.T_DOC_REQ_ACPT_DATE, T74041.T_OPER_DES_CODE, T74041.T_OPER_ACPT_DATE, T74041.T_DISCH_STATUS, T74041.T_CASE_ARRIVAL, T74041.T_PROTOCAL_NO FROM T74041 LEFT JOIN T74046 ON T74041.T_PAT_ID = T74046.T_PAT_ID LEFT JOIN T74050 ON T74050.T_SEX_CODE = T74046.T_SEX_CODE LEFT OUTER JOIN T74044 ON T74041.T_AMBU_REG_ID = T74044.T_AMBU_REG_ID LEFT OUTER JOIN T02065 ON T74041.T_SITE_DIS_CODE = T02065.T_SITE_CODE LEFT OUTER JOIN T74057 ON T74041.T_USER_ID = T74057.T_USER_ID LEFT OUTER JOIN T74004 ON T74057.T_EMP_ID = T74004.T_EMP_ID LEFT OUTER JOIN T74015 ON T74057.T_EMP_ID = T74015.T_EMP_ID LEFT OUTER JOIN T74005 ON T74004.T_EMP_TYP_ID = T74005.T_EMP_TYP_ID WHERE T74057.T_ZONE_CODE = '{zonCode}' GROUP BY T74041.T_PAT_ID, T74041.T_REQUEST_DATE, T74041.T_REQUEST_TIME, T74041.T_REQUEST_ID, T74046.T_FIRST_LANG{language}_NAME, T74046 .T_FATHER_LANG{language}_NAME , T74046.T_GFATHER_LANG{language}_NAME, T74041.T_AGE, T74050.T_SHORT_GNDR_NAME, T74041.T_AMBU_REG_ID, T74057.T_USER_ID, T74004.T_FIRST_LANG{language}_NAME, T74004.T_GFATHER_LANG{language}_NAME, 'Name: ' || T74046.T_FIRST_LANG{language}_NAME || ' ' || T74046.T_FATHER_LANG{language}_NAME || ' ' || T74046.T_GFATHER_LANG{language}_NAME ||' ' || 'Age: ' || ' ' || T74041.T_AGE || ' ' || 'Sex: ' || ' ' || T74050.T_SHORT_GNDR_NAME || ' ' ||'Mob: ' || T74046.T_MOBILE_NO, 'Amb ID: ' || T74041.T_AMBU_REG_ID || ' ' || 'Team ID: ' ||T74057.T_USER_ID || ' ' || 'Cont.Person: ' || T74004.T_FIRST_LANG{language}_NAME || ' ' ||T74004.T_FATHER_LANG{language}_NAME || ' ' || T74004.T_GFATHER_LANG{language}_NAME || ' ' || 'Mob: ' ||T74004.T_MOBILE_NO , T74041.T_ASSIGN_TIME , T74041.T_ASSIGN_TIME , T74041.T_ACCEPT_TIME , T74041.T_ACCEPT_TIME , T74041.T_SEEN_DATE , T74041.T_SEEN_TIME , T74041.T_START_TIME, T74041.T_START_TIME, T02065.T_LANG{language}_NAME, T74041.T_CANCEL_STATUS, T74041.T_CANCEL_REASON, T74041.T_CAN_DATE, T74041.T_OPER_CNCL_DATE, T74041.T_DISCHARGE_DATE, T74041.T_DISCHARGE_TIME, T74041.T_TEAM_ARVL_HOS , T74041.T_TEAM_ARVL_STN , T74041.T_TEAM_DEPT_HOS, T74041.T_OPER_CNCL_FLAG, T74041.T_REF_DOC_CODE, T74041.T_DOC_REQ_ACPT_DATE, T74041.T_OPER_DES_CODE, T74041.T_OPER_ACPT_DATE, T74041.T_DISCH_STATUS, T74041.T_CASE_ARRIVAL, T74041.T_PROTOCAL_NO UNION SELECT NULL AS T_PAT_ID, T_ENTRY_TIME AS T_REQUEST_DATE, T_ENTRY_TIME AS T_REQUEST_TIME, T_REQUEST_ID, NULL AS T_FIRST_NAME, NULL AS T_FATHER_NAME, NULL AS T_GFATHER_NAME, NULL AS T_AGE, NULL AS T_SHORT_GNDR_NAME, NULL AS T_AMBU_REG_ID, NVL(T_USER_ID,T_DEVICES) T_USER_ID, NULL AS T_OPE_FIRST_NAME, NULL AS T_OPE_LAST_NAME, NULL AS T_PAT_INFO, NULL AS T_ASSIGN_TO, NULL AS DOCTOR_INFO, NULL AS ASIGN_DATE, NULL AS ASIGN_TIME, NULL AS ACCEPT_DATE, NULL AS ACCEPT_TIME, NULL AS CASE_RECEIVED_DATE, NULL AS CASE_RECEIVED_TIME, NULL AS T_CANCEL_STATUS, NULL AS T_CANCEL_REASON, NULL AS T_CAN_DATE, NULL AS T_OPER_CNCL_DATE, NULL AS DIST_START_DATE, NULL AS DIST_START_TIME, T_ADDRESS AS HANDOVER_TO, NULL AS HANDOVER_DATE, NULL AS HANDOVER_TIME, NULL AS HOSPITAL_ARRIVAL, NULL AS HOSPITAL_STATION, NULL AS HOSPITAL_DEPARTURE, T_PANIC_ID, NULL AS T_OPER_CNCL_FLAG, NULL AS T_REF_DOC_CODE, NULL AS T_DOC_REQ_ACPT_DATE, NULL AS T_OPER_DES_CODE, NULL AS T_OPER_ACPT_DATE, NULL AS T_DISCH_STATUS, NULL AS T_CASE_ARRIVAL, NULL AS T_PROTOCAL_NO FROM (SELECT t74103.T_USER_ID, T_DEVICES, T_ENTRY_TIME, T_REQUEST_ID, T_ADDRESS, T_PANIC_ID, rank() over (partition BY t74103.T_USER_ID order by T_ENTRY_TIME DESC) ranks FROM t74103 LEFT OUTER JOIN T74057 ON t74103.T_USER_ID = T74057.T_USER_ID WHERE T74057.T_ZONE_CODE = '{zonCode}' ) WHERE ranks = 1 ) ORDER BY T_PROTOCAL_NO DESC NULLS LAST,  T_REQUEST_ID DESC NULLS LAST,T_PAT_ID");
        }



        public DataTable GetCriterias(string rolecode, string language)
        {
            return Query($"SELECT T00.T_EVENT_ID,DECODE(T00.T_EVENT_ID,16,T00.T_LANG{language}_NAME,T00.T_LANG{language}_NAME||' by '||DECODE(T00.T_ROLE_CODE,86,'Operator',24,'TEAM',81,'Doctor',111,'Asos'))  T_LANG2_NAME FROM T74100 T00 WHERE T00.T_EVENT_ID<17");
        }
    }
}