using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Web;

namespace AmbucareDAL.Repository.DAL.Report
{
    public class R74123DAL : CommonDAL
    {
        public DataTable GetPatientDetails(int requestid)
        {
                return Query("SELECT T74054.T_LANG2_NAME COMPANY_NAME,T74054.T_LANG2_ADRS_NAME COMPANY_ADDRESS,T74054.T_EMAIL COMPANY_EMAIL,T74054.T_PHONE COMPANY_CONTACT_NO,T_WEB_URL COMPANY_WEB_ADDRESS,Get_Driver_Contact_No(T74041.T_AMBU_REG_ID) EMERGENCY_CONTACT,T74039.T_PRESCRIPTION_ID,T74046.T_PAT_ID,T74046.T_FIRST_LANG2_NAME|| ' ' ||T74046.T_FATHER_LANG2_NAME || ' ' || T74046.T_GFATHER_LANG2_NAME || ' ' || T74046.T_FAMILY_LANG2_NAME PAT_NAME,T74050.T_LANG2_NAME GENDER,TRUNC(MONTHS_BETWEEN(SysDate, T74046.T_BIRTH_DATE) / 12, 0)|| ' Yrs '|| TRUNC(MOD(MONTHS_BETWEEN(SysDate, T74046.T_BIRTH_DATE), 12), 0)|| ' Months' AGE,T74051.T_LANG2_NAME MARITAL_STATUS,T02003.T_LANG2_NAME NATIONALITY,T74046.T_MOBILE_NO,T74046.T_ADDRESS1||'-'|| T74046.T_POSTAL_CODE ADDRESS,T74004.T_FIRST_LANG2_NAME||' '||T74004.T_FATHER_LANG2_NAME|| ' '|| T74004.T_GFATHER_LANG2_NAME|| ' '|| T74004.T_FAMILY_LANG2_NAME DOC_NAME,T74022.T_LANG2_NAME DEGREE_NAME,T74020.T_LANG2_NAME SPECIALITY_NAME,T74021.T_LANG2_NAME DEPT_NAME,T74041.T_PROBLEM,T74041.T_PROBLEM_DURATION,T74041.T_PROB_DETAILS,T74055.T_LANG2_NAME CH_COMPLIENT,T74043.T_HIGHT,T74043.T_WEIGHT,T74043.T_BP_SYS,T74043.T_BP_DIA,T74043.T_TEMP,T74043.T_PULS,T74043.T_BSUGAR_F,T74039.T_REMARKS,T74039.T_ENTRY_DATE ,'Trade Name' TRADE_GEN,V30001.PRODUCT_DESC MED_NAME,GetDoseQuantity(T74040.T_PRSCRPTN_DTL_ID) DOSE_QUANTITY,T74040.T_MORNING_DOSE_UNIT ||' + '|| T74040.T_NOON_DOSE_UNIT ||' + '|| T74040.T_NIGHT_DOSE_UNIT ||' unit '|| DECODE(T74040.T_MEAL_INSTRUCTION, 1 , 'Before '|| T74040.T_INS_TIME||' Minutes of Meal', 2 , 'During Meal', 3 , 'After '|| T74040.T_INS_TIME||' Minutes of Meal','N/A') DOSES ,T74040.T_FREQUENCY_CODE ||' Per '||Get_T74076_Lang2(T74040.T_FREQUENCY_INS_ID) FREQUENCY ,' for '||T74040.T_DOSE_DURATION_CODE ||' '|| Get_T74076_Lang2(T74040.T_DOSE_DURATION_INS_ID) DURATION ,T74040.T_REMARKS_DTL,T74040.T_SATURDAY,T74040.T_SUNDAY,T74040.T_MONDAY,T74040.T_TUESDAY,T74040.T_WEDNESDAY,T74040.T_THURSDAY ,T74040.T_FRIDAY,T74040.T_DRUG_INACTIVE_FLAG FROM T74046 INNER JOIN T74050 ON T74046.T_SEX_CODE = T74050.T_SEX_CODE INNER JOIN T74051 ON T74046.T_MRTL_STATUS = T74051.T_MRTL_STATUS_CODE INNER JOIN T02003 ON T74046.T_NTNLTY_ID = T02003.T_NTNLTY_ID INNER JOIN T74041 ON T74046.T_PAT_ID = T74041.T_PAT_ID INNER JOIN T74043 ON T74041.T_REQUEST_ID = T74043.T_REQUEST_ID INNER JOIN T74039 ON T74039.T_REQUEST_ID = T74043.T_REQUEST_ID INNER JOIN T74015 ON T74041.T_AMBU_REG_ID = T74015.T_AMBU_REG_ID INNER JOIN T74004 ON T74015.T_EMP_ID = T74004.T_EMP_ID INNER JOIN T74005 ON T74004.T_EMP_TYP_ID = T74005.T_EMP_TYP_ID  INNER JOIN T74020 ON T74020.T_DOC_SPECI_ID  = T74004.T_DOC_SPECI_ID INNER JOIN T74021 ON T74021.T_DOC_DEPT_ID  = T74004.T_DOC_DEPT_ID INNER JOIN T74022 ON T74022.T_DOC_DEGREE_ID  = T74004.T_DOC_DEGREE_ID INNER JOIN T74040 ON T74039.T_PRESCRIPTION_ID = T74040.T_PRESCRIPTION_ID INNER JOIN T74073 ON T74073.T_ID = T74040.T_ITEM_CODE INNER JOIN T74054 ON T74054.T_COMPANY_ID  = T74041.T_COMPANY_ID INNER JOIN T74055 ON T74055.T_CH_COMP = T74041.T_CH_COMP INNER JOIN RUFAIDA.V30001 ON V30001.ITEM_CODE = T74040.T_ITEM_CODE WHERE T74039.T_DOC_ID    = T74015.T_EMP_ID AND (T74005.T_EMP_TYP_ID = 2) AND T74039.T_REQUEST_ID = " + requestid + " UNION SELECT T74054.T_LANG2_NAME COMPANY_NAME ,T74054.T_LANG2_ADRS_NAME COMPANY_ADDRESS,T74054.T_EMAIL COMPANY_EMAIL ,T74054.T_PHONE COMPANY_CONTACT_NO,T_WEB_URL COMPANY_WEB_ADDRESS ,Get_Driver_Contact_No(T74041.T_AMBU_REG_ID) EMERGENCY_CONTACT,T74039.T_PRESCRIPTION_ID ,T74046.T_PAT_ID, T74046.T_FIRST_LANG2_NAME  || ' ' || T74046.T_FATHER_LANG2_NAME || ' ' || T74046.T_GFATHER_LANG2_NAME   || ' ' || T74046.T_FAMILY_LANG2_NAME PAT_NAME,  T74050.T_LANG2_NAME GENDER, TRUNC(MONTHS_BETWEEN(SysDate, T74046.T_BIRTH_DATE) / 12, 0) || ' Yrs ' || TRUNC(MOD(MONTHS_BETWEEN(SysDate, T74046.T_BIRTH_DATE), 12), 0)  || ' Months' AGE, T74051.T_LANG2_NAME MARITAL_STATUS, T02003.T_LANG2_NAME NATIONALITY,   T74046.T_MOBILE_NO,  T74046.T_ADDRESS1||'-'|| T74046.T_POSTAL_CODE ADDRESS, T74004.T_FIRST_LANG2_NAME || ' '  || T74004.T_FATHER_LANG2_NAME  || ' ' || T74004.T_GFATHER_LANG2_NAME || ' ' || T74004.T_FAMILY_LANG2_NAME DOC_NAME, T74022.T_LANG2_NAME DEGREE_NAME ,T74020.T_LANG2_NAME SPECIALITY_NAME ,T74021.T_LANG2_NAME DEPT_NAME ,T74041.T_PROBLEM ,T74041.T_PROBLEM_DURATION ,T74041.T_PROB_DETAILS ,T74055.T_LANG2_NAME CH_COMPLIENT ,T74043.T_HIGHT ,T74043.T_WEIGHT ,T74043.T_BP_SYS ,T74043.T_BP_DIA ,T74043.T_TEMP ,T74043.T_PULS ,T74043.T_BSUGAR_F  ,T74039.T_REMARKS, T74039.T_ENTRY_DATE ,'Gen Name' TRADE_GEN, V30001.GEN_DESC || ' ' || T74040.T_REQUEST_STRENGTH || ' ' || V30001.ROUTE_DESC || ' ' || V30001.FORM_DESC MED_NAME, GetDoseQuantity(T74040.T_PRSCRPTN_DTL_ID) DOSE_QUANTITY  ,T74040.T_MORNING_DOSE_UNIT ||' + '|| T74040.T_NOON_DOSE_UNIT ||' + '|| T74040.T_NIGHT_DOSE_UNIT ||' unit '|| DECODE(T74040.T_MEAL_INSTRUCTION, 1 , 'Before '|| T74040.T_INS_TIME||' Minutes of Meal', 2 , 'During Meal', 3 , 'After '|| T74040.T_INS_TIME||' Minutes of Meal','N/A') DOSES ,T74040.T_FREQUENCY_CODE ||' Per '||Get_T74076_Lang2(T74040.T_FREQUENCY_INS_ID) FREQUENCY ,' for '||T74040.T_DOSE_DURATION_CODE ||' '|| Get_T74076_Lang2(T74040.T_DOSE_DURATION_INS_ID) DURATION ,T74040.T_REMARKS_DTL,T74040.T_SATURDAY ,T74040.T_SUNDAY ,T74040.T_MONDAY ,T74040.T_TUESDAY ,T74040.T_WEDNESDAY ,T74040.T_THURSDAY ,T74040.T_FRIDAY ,T74040.T_DRUG_INACTIVE_FLAG FROM T74046 INNER JOIN T74050 ON T74046.T_SEX_CODE = T74050.T_SEX_CODE INNER JOIN T74051 ON T74046.T_MRTL_STATUS = T74051.T_MRTL_STATUS_CODE INNER JOIN T02003 ON T74046.T_NTNLTY_ID = T02003.T_NTNLTY_ID INNER JOIN T74041 ON T74046.T_PAT_ID = T74041.T_PAT_ID INNER JOIN T74043 ON T74041.T_REQUEST_ID = T74043.T_REQUEST_ID INNER JOIN T74039 ON T74039.T_REQUEST_ID = T74043.T_REQUEST_ID INNER JOIN T74015 ON T74041.T_AMBU_REG_ID = T74015.T_AMBU_REG_ID INNER JOIN T74004 ON T74015.T_EMP_ID = T74004.T_EMP_ID INNER JOIN T74005 ON T74004.T_EMP_TYP_ID = T74005.T_EMP_TYP_ID INNER JOIN T74020 ON T74020.T_DOC_SPECI_ID  = T74004.T_DOC_SPECI_ID INNER JOIN T74021 ON T74021.T_DOC_DEPT_ID  = T74004.T_DOC_DEPT_ID INNER JOIN T74022 ON T74022.T_DOC_DEGREE_ID  = T74004.T_DOC_DEGREE_ID INNER JOIN T74040 ON T74039.T_PRESCRIPTION_ID = T74040.T_PRESCRIPTION_ID INNER JOIN T74054 ON T74054.T_COMPANY_ID  = T74041.T_COMPANY_ID INNER JOIN T74055 ON T74055.T_CH_COMP = T74041.T_CH_COMP INNER JOIN RUFAIDA.V30001 ON T74040.T_GEN_CODE = V30001.GEN_CODE WHERE T74039.T_DOC_ID    = T74015.T_EMP_ID AND (T74005.T_EMP_TYP_ID = 2) AND  T74040.T_ITEM_CODE IS NULL AND T74040.T_GEN_CODE = V30001.GEN_CODE AND  T74040.T_FORM_ID = V30001.FORM_CODE AND  T74040.T_DRUG_ROUTE_CODE = V30001.ROUTE_CODE AND  T74040.T_REQUEST_STRENGTH = V30001.STRENGTH AND T74039.T_REQUEST_ID = " + requestid + " GROUP BY  T74054.T_LANG2_NAME  ,T74054.T_LANG2_ADRS_NAME ,T74054.T_EMAIL ,T74054.T_PHONE ,T_WEB_URL  ,T74046.T_PAT_ID,  T74043.T_REQUEST_ID,  T74041.T_AMBU_REG_ID,  T74046.T_FIRST_LANG2_NAME  ,T74046.T_FATHER_LANG2_NAME   ,T74046.T_GFATHER_LANG2_NAME  ,T74046.T_FAMILY_LANG2_NAME  ,T74050.T_LANG2_NAME  ,T74046.T_BIRTH_DATE  ,T74051.T_LANG2_NAME   ,T02003.T_LANG2_NAME   ,T74046.T_MOBILE_NO  ,T74046.T_ADDRESS1  ,T74046.T_POSTAL_CODE  ,T74022.T_LANG2_NAME   ,T74020.T_LANG2_NAME    ,T74041.T_PROBLEM   ,T74041.T_PROBLEM_DURATION   ,T74041.T_PROB_DETAILS   ,T74055.T_LANG2_NAME   ,T74043.T_HIGHT  ,T74043.T_WEIGHT ,T74043.T_BP_SYS   ,T74043.T_BP_DIA   ,T74043.T_TEMP   ,T74043.T_PULS   ,T74043.T_BSUGAR_F   ,T74039.T_REMARKS  ,T74004.T_FIRST_LANG2_NAME   ,T74004.T_FATHER_LANG2_NAME   ,T74004.T_GFATHER_LANG2_NAME   ,T74004.T_FAMILY_LANG2_NAME ,T74021.T_LANG2_NAME   ,T74039.T_PRESCRIPTION_ID   ,T74039.T_ENTRY_DATE   ,V30001.GEN_DESC ,T74040.T_REQUEST_STRENGTH ,V30001.ROUTE_DESC ,V30001.FORM_DESC  ,T74040.T_PRSCRPTN_DTL_ID ,T74040.T_MORNING_DOSE_UNIT ,T74040.T_NOON_DOSE_UNIT ,T74040.T_NIGHT_DOSE_UNIT  ,T74040.T_MEAL_INSTRUCTION ,T74040.T_INS_TIME ,T74040.T_FREQUENCY_CODE ,T74040.T_FREQUENCY_INS_ID ,T74040.T_DOSE_DURATION_CODE ,T74040.T_DOSE_DURATION_INS_ID ,T74040.T_REMARKS_DTL ,T74040.T_SATURDAY ,T74040.T_SUNDAY ,T74040.T_MONDAY ,T74040.T_TUESDAY ,T74040.T_WEDNESDAY ,T74040.T_THURSDAY ,T74040.T_FRIDAY ,T74040.T_DRUG_INACTIVE_FLAG");
           
        }

        public DataTable GetPatientBodMeasure(int t_REQUEST_ID)
        {
            return Query("select T74041.T_REQUEST_ID, T74046.T_PAT_ID,   T74046.T_FIRST_LANG2_NAME   || ' '   ||T74046.T_FATHER_LANG2_NAME   || ' '   || T74046.T_GFATHER_LANG2_NAME   || ' '   || T74046.T_FAMILY_LANG2_NAME PAT_NAME,  T74050.T_LANG2_NAME GENDER,   TRUNC(MONTHS_BETWEEN(SysDate, T74046.T_BIRTH_DATE) / 12, 0)   || ' Yrs '   || TRUNC(MOD(MONTHS_BETWEEN(SysDate, T74046.T_BIRTH_DATE), 12), 0)   || ' Months' AGE,   T74051.T_LANG2_NAME MARITAL_STATUS,   T02003.T_LANG2_NAME NATIONALITY,   T74046.T_MOBILE_NO,   T74046.T_ADDRESS1   ||'-'   || T74046.T_POSTAL_CODE ADDRESS,    T74043.T_HIGHT ,   T74043.T_WEIGHT ,   T74043.T_BP_SYS ,  T74043.T_BP_DIA ,   T74043.T_TEMP ,   T74043.T_PULS ,   T74043.T_BSUGAR_F,T74054.T_COMPANY_ID,T74054.T_LANG2_NAME,T74054.T_LANG2_ADRS_NAME,T74054.T_EMAIL,T74054.T_PHONE,T74054.T_WEB_URL   from T74046  INNER JOIN T74050 ON T74046.T_SEX_CODE = T74050.T_SEX_CODE  INNER JOIN T74051 ON T74046.T_MRTL_STATUS = T74051.T_MRTL_STATUS_CODE  INNER JOIN T02003 ON T74046.T_NTNLTY_ID = T02003.T_NTNLTY_ID  INNER JOIN T74041 ON T74046.T_PAT_ID = T74041.T_PAT_ID  INNER JOIN T74043 ON T74041.T_REQUEST_ID = T74043.T_REQUEST_ID INNER JOIN T74054 ON T74054.T_COMPANY_ID = T74041.T_COMPANY_ID  where T74041.T_REQUEST_ID = '"+ t_REQUEST_ID + "'");
        }
    }
}