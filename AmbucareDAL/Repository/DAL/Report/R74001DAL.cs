using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Web;

namespace AmbucareDAL.Repository.DAL.Report
{
    public class R74001DAL : CommonDAL
    {
        public DataTable GetPatientDetails(String Condition)
        {
            return Query("SELECT DISTINCT T74046.T_FIRST_LANG2_NAME ||' ' ||T74046.T_FATHER_LANG2_NAME T_FIRST_LANG2_NAME, T74046.T_MOBILE_NO, T74041.T_PROB_DETAILS, T74054.T_LANG2_NAME Company_Name, T74054.T_LANG2_ADRS_NAME, T74054.T_PHONE, T74054.T_EMAIL, T74054.T_WEB_URL FROM T74046 JOIN T74041 ON T74046.T_PAT_ID = T74041.T_PAT_ID JOIN T74054 ON T74041.T_COMPANY_ID = T74054.T_COMPANY_ID JOIN T74015 ON T74041.T_AMBU_REG_ID =T74015.T_AMBU_REG_ID JOIN T74057 ON T74015.T_EMP_ID = T74057.T_EMP_ID " + Condition + "");
        }

        public DataTable GetWaittingAmbulanceDetails()
        {
            return Query("SELECT DISTINCT T74044.T_LANG2_NAME, T74004.T_FIRST_LANG2_NAME ||T74004.T_FATHER_LANG2_NAME ||' '|| T74004.T_GFATHER_LANG2_NAME OperatorName, T74054.T_LANG2_NAME Company_Name, T74054.T_LANG2_ADRS_NAME, T74054.T_PHONE, T74054.T_EMAIL, T74054.T_WEB_URL FROM T74057 JOIN T74015 ON T74057.T_EMP_ID = T74015.T_EMP_ID JOIN T74054 ON T74057.T_COMPANY_ID = T74054.T_COMPANY_ID JOIN T74004 ON T74015.T_EMP_ID = T74004.T_EMP_ID JOIN T74044 ON T74015.T_AMBU_REG_ID =T74044.T_AMBU_REG_ID WHERE T_LOGIN_STATUS = 1 AND T74044.T_AMBU_REG_ID != 0");
        }

        public DataTable ReportPatientDetails(int t_AMBU_REG_ID)
        {
            return Query("Select DISTINCT T74044.T_AMBU_REG_ID, T74044.T_LANG2_NAME Ambulance, T74004.T_FATHER_LANG2_NAME ||' '  || T74004.T_GFATHER_LANG2_NAME Name,  T74005.T_LANG2_NAME Employee_Type, T74046.T_FIRST_LANG2_NAME Patient_Name,T74054.T_LANG2_NAME Company_Name,T74054.T_LANG2_ADRS_NAME,T74054.T_PHONE,T74054.T_EMAIL,T74054.T_WEB_URL  from T74044 join T74015 on T74044.T_AMBU_REG_ID = T74015.T_AMBU_REG_ID join T74004 on T74015.T_EMP_ID = T74004.T_EMP_ID join T74041 on T74044.T_AMBU_REG_ID =T74041.T_AMBU_REG_ID JOIN T74054 ON T74041.T_COMPANY_ID =T74054.T_COMPANY_ID join T74046 on T74041.T_PAT_ID = T74046.T_PAT_ID  join T74005 on T74004.T_EMP_TYP_ID =T74005.T_EMP_TYP_ID  where T74044.T_AMBU_REG_ID = " + t_AMBU_REG_ID + " AND T74041.T_DISCH_STATUS IS NULL");
        }
    }
}